const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/single_user-C98jTg_i.js","assets/index-B0RY7NYi.js","assets/index-CDrq-qvZ.css","assets/group_user-DgdILMzN.js","assets/friends-CCaVi4-G.js","assets/copy-DxDZj_33.js","assets/info_friends-jaQjbpHJ.js"])))=>i.map(i=>d[i]);
import{_ as xe,s as Fe,b as Be,a as $e,r as g,v as ie,w as Te,x as Ie,y as Pe,e as v,c as re,z as h,f as e,S as Ee,T as Me,M as Ae,t as i,i as o,p as w,g as k,j as T,F as S,B as N,A as m,U as _e,l as I,m as ce,o as c,C as L,D as O}from"./index-B0RY7NYi.js";const Ve="/assets/ref_card1-BwzG-6mt.webp",Se="/assets/ref_card2-BgPE-OXE.webp",De="/assets/ref_card3-B_GW0dsM.webp",Re="/assets/asic_ref-BMar_rII.webp",Ne={class:"screen-box"},Le={class:"title"},Oe={class:"desc"},ze={class:"friend-grid"},Ue={class:"item invite"},Ge={class:"buttons-group"},We={class:"bonus-cards"},je={class:"title"},Xe={key:0,src:Ve,width:"62px",height:"62px"},qe={key:1,src:Se,width:"62px",height:"62px"},He={key:2,src:De,width:"62px",height:"62px"},Je={class:"bonus-data"},Ke={style:{color:"#fcd909","font-weight":"bold"}},Qe={style:{color:"#fcd909","font-weight":"bold"}},Ye={class:"price"},Ze={key:0,src:L,width:"10px"},et={key:1,src:O,width:"10px"},tt=["onClick"],st={class:"group-friend-count"},lt={class:"title"},nt={class:"friend-counter"},ot={class:"single"},at={style:{color:"#fcd909"}},ut={class:"group"},it={style:{color:"#fcd909"}},rt={key:0,class:"sorting"},_t={class:"first-sec"},ct={class:"friend-id"},vt={class:"friend-name"},dt={class:"second-sec"},bt={class:"currency-line"},pt={class:"grouping"},gt={class:"energy"},ht={class:"grouping"},ft={class:"tbtc"},mt={class:"currency-line"},wt={class:"grouping"},kt={class:"energy"},yt={class:"grouping"},Ct={class:"tbtc"},xt={class:"third-sec"},Ft={class:"grouping"},Bt={class:"tbtc"},$t={key:1,class:"friend-pagination"},Tt={class:"pages"},It={class:"page-group"},Pt={class:"navigate-control"},Et={__name:"FriendsView",setup(Mt){var G,W,j;const z=T(()=>I(()=>import("./single_user-C98jTg_i.js"),__vite__mapDeps([0,1,2]))),U=T(()=>I(()=>import("./group_user-DgdILMzN.js"),__vite__mapDeps([3,1,2]))),ve=T(()=>I(()=>import("./friends-CCaVi4-G.js"),__vite__mapDeps([4,1,2]))),de=T(()=>I(()=>import("./copy-DxDZj_33.js"),__vite__mapDeps([5,1,2]))),be=T(()=>I(()=>import("./info_friends-jaQjbpHJ.js"),__vite__mapDeps([6,1,2]))),n=Fe(),{user:y}=Be(),{t:r}=$e();let f=null;const C=g(!1),F=g(null),B=g(null),$=g(null),t=g(null),a=g("btl"),x=g(((G=n==null?void 0:n.referal)==null?void 0:G.referrals)||[]),P=g(Math.ceil((((W=n==null?void 0:n.referal)==null?void 0:W.first_level_count)+((j=n==null?void 0:n.referal)==null?void 0:j.second_level_count))/100)||0),p=g(1),D=g(null),E=g(!1),M=u=>{if(D.value&&D.value.scrollTo({top:0,behavior:"smooth"}),u=="num")t.value!==null&&t.value!=="num"?(t.value="num",a.value="btl"):a.value=="ltb"&&t.value!==null?(t.value=null,a.value="btl"):a.value=="btl"&&t.value!==null?(t.value="num",a.value="ltb"):t.value==null&&(t.value="num",a.value="btl");else if(u=="kw")t.value!==null&&t.value!=="bring_bonus_kw_level_1"?(t.value="bring_bonus_kw_level_1",a.value="btl"):a.value=="ltb"&&t.value!==null?(t.value=null,a.value="btl"):a.value=="btl"&&t.value!==null?(t.value="bring_bonus_kw_level_1",a.value="ltb"):t.value==null&&(t.value="bring_bonus_kw_level_1",a.value="btl");else if(u=="tbtc")t.value!==null&&t.value!=="bring_bonus_tbtc_level_1"?(t.value="bring_bonus_tbtc_level_1",a.value="btl"):a.value=="ltb"&&t.value!==null?(t.value=null,a.value="btl"):a.value=="btl"&&t.value!==null?(t.value="bring_bonus_tbtc_level_1",a.value="ltb"):t.value==null&&(t.value="bring_bonus_tbtc_level_1",a.value="btl");else if(u=="nft")t.value!==null&&t.value!=="nft_count"?(t.value="nft_count",a.value="btl"):a.value=="ltb"&&t.value!==null?(t.value=null,a.value="btl"):a.value=="btl"&&t.value!==null?(t.value="nft_count",a.value="ltb"):t.value==null&&(t.value="nft_count",a.value="btl");else return},pe=()=>{const u=`https://t.me/share/url?url=https://t.me/tBTCminer_bot?startapp=ref_id${y==null?void 0:y.id}&text=Присоединяйся к TonBitcoin Mine`;return window.location.href=u},ge=[{type:"energy",title:r("friends.bonus_title_1"),per_friend:10,per_next:5},{type:"mining",title:r("friends.bonus_title_2"),per_friend:6,per_next:3},{type:"staking",title:r("friends.bonus_title_3"),per_friend:5,per_next:2}],he=()=>{const u=`https://t.me/tBTCminer_bot?startapp=ref_id${y==null?void 0:y.id}`;return F.value="success",B.value=r("notification.st_success"),$.value=r("notification.invite_copied"),C.value=!0,navigator.clipboard.writeText(u)},fe=u=>ie(()=>({background:`radial-gradient(ellipse 50% 40% at center, ${u==0?"#3B62C0":u==1?"#197A3F":"#8143FC"}, transparent)${u==1?", #0B150F":""}`})),me=async u=>{if(u!="error"&&(await n.initFriends(),!(+(n.user.bonus_kw_level_1+n.user.bonus_kw_level_2)==0&&u=="energy")&&!(+(n.user.bonus_tbtc_level_1+n.user.bonus_tbtc_level_2)==0&&u=="tbtc")&&!(+(n.user.bonus_invest_level_1+n.user.bonus_invest_level_2)==0&&u=="staking")))try{f=new AbortController,(await ce.post(`${u=="energy"?"get-kw-referral-bonuses":u=="tbtc"?"get-tbtc-referral-bonuses":u=="staking"?"get-staking-referral-bonuses":null}/`,{signal:f.signal})).status==200&&(F.value="success",B.value=r("notification.st_success"),$.value=r("notification.bonus_withdrawed"),C.value=!0,await n.initFriends())}catch(l){console.log(l),F.value="error",B.value=r("notification.st_error"),$.value=l.response.data.error||l.data.error||l.data.message||r("notification.was_error"),C.value=!0,await n.initFriends()}finally{f=null}},we=ie(()=>{const u=P.value,l=p.value;if(u<=8)return[...Array(u)].map((s,_)=>_+1);const d=[],b=1;d.push(1),l-b>2&&d.push("...");const A=Math.max(2,l-b),V=Math.min(u-1,l+b);for(let s=A;s<=V;s++)d.push(s);return l+b<u-1&&d.push("..."),u>1&&d.push(u),d}),R=async u=>{var l;try{const d={page:u,page_size:100,ordering:t.value?`${a.value==="ltb"?"":"-"}${t.value}`:null};f=new AbortController;const b=await ce.get("referral-info/",{params:d,signal:f.signal});b.status===200&&(x.value=(l=b.data)==null?void 0:l.referrals,n.setReferrals(b.data),P.value=Math.ceil((b.data.first_level_count+b.data.second_level_count)/100))}catch(d){console.error("Ошибка загрузки:",d),F.value="error",B.value=r("notification.st_error"),$.value=r("notification.ref_load_err"),C.value=!0}finally{f=null}},ke=()=>{if(p.value<P.value)p.value++,R(p.value);else return},ye=()=>{if(p.value>1)p.value--,R(p.value);else return};return Te([t,a],()=>{p.value=1,R(1)},{immediate:!0}),Ie(async()=>{await n.initFriends()}),Pe(()=>{f&&f.abort()}),(u,l)=>{var d,b,A,V;return c(),v(S,null,[E.value?(c(),re(Me,{key:0,onClose:l[0]||(l[0]=s=>E.value=!E.value)},{"modal-body":Ee(()=>[w(i(o(r)("modals.friend_info.message")),1)]),_:1})):h("",!0),C.value?(c(),re(Ae,{key:1,status:F.value,title:B.value,body:$.value,onClose:l[1]||(l[1]=s=>C.value=!1)},null,8,["status","title","body"])):h("",!0),e("div",Ne,[e("h1",Le,i(o(r)("friends.title")),1),e("h5",Oe,i(o(r)("friends.desc")),1),e("div",ze,[e("div",Ue,[e("div",Ge,[e("button",{class:"invite-btn",onClick:pe},[w(i(o(r)("friends.invite_btn"))+" ",1),k(o(ve),{width:22,style:{color:"#212121"}})]),e("button",{class:"copy-btn",onClick:he},[k(o(de),{width:16})])])]),e("div",We,[(c(),v(S,null,N(ge,(s,_)=>{var X,q,H,J,K,Q,Y,Z,ee,te,se,le,ne,oe,ae,ue;return e("div",{class:"bonus-card",key:_,style:_e(fe(_).value)},[k(o(be),{class:"bonus-card-info",width:"17px",height:"17px",onClick:l[2]||(l[2]=Ce=>E.value=!0)}),e("h1",je,i(s.title),1),l[7]||(l[7]=e("div",{class:"light-line"},null,-1)),_==0?(c(),v("img",Xe)):h("",!0),_==1?(c(),v("img",qe)):h("",!0),_==2?(c(),v("img",He)):h("",!0),e("div",Je,[e("span",null,[e("span",Ke,i(s.per_friend)+"% ",1),w(i(o(r)("friends.bonus_desc_1")),1)]),e("span",null,[e("span",Qe,i(s.per_next)+"% ",1),w(i(o(r)("friends.bonus_desc_2")),1)])]),e("span",Ye,[_==0?(c(),v("img",Ze)):h("",!0),_!==0?(c(),v("img",et)):h("",!0),w(" "+i(_==0?+(((q=(X=o(n))==null?void 0:X.user)==null?void 0:q.bonus_kw_level_1)+((J=(H=o(n))==null?void 0:H.user)==null?void 0:J.bonus_kw_level_2)).toFixed(2):_==1?+(((Q=(K=o(n))==null?void 0:K.user)==null?void 0:Q.bonus_tbtc_level_1)+((Z=(Y=o(n))==null?void 0:Y.user)==null?void 0:Z.bonus_tbtc_level_2)).toFixed(2):_==2?+(((te=(ee=o(n))==null?void 0:ee.user)==null?void 0:te.bonus_invest_level_1)+((le=(se=o(n))==null?void 0:se.user)==null?void 0:le.bonus_invest_level_2)).toFixed(2):"0"),1)]),e("button",{class:m(["get-bonus-button",{unactive:_==0&&+(o(n).user.bonus_kw_level_1+o(n).user.bonus_kw_level_2)==0||_==1&&+(o(n).user.bonus_tbtc_level_1+o(n).user.bonus_tbtc_level_2)==0||_==2&&+(((oe=(ne=o(n))==null?void 0:ne.user)==null?void 0:oe.bonus_invest_level_1)+((ue=(ae=o(n))==null?void 0:ae.user)==null?void 0:ue.bonus_invest_level_2))==0}]),onClick:Ce=>me(_==0?"energy":_==1?"tbtc":_==2?"staking":"error")},i(o(r)("friends.bonus_take_btn")),11,tt)],4)}),64))]),e("div",st,[e("span",lt,i(o(r)("friends.friends_list_title")),1),e("div",nt,[e("span",ot,[k(o(z),{width:17,height:17}),e("span",at,i(((b=(d=o(n))==null?void 0:d.referal)==null?void 0:b.first_level_count)||0),1),w(i(o(r)("friends.ref")),1)]),e("span",ut,[k(o(U),{width:17,height:17}),e("span",it,i(((V=(A=o(n))==null?void 0:A.referal)==null?void 0:V.second_level_count)||0),1),w(i(o(r)("friends.ref")),1)])]),x.value.length>0?(c(),v("div",rt,[e("div",{class:m(["sort-pill",{selected:t.value=="num"}]),onClick:l[3]||(l[3]=s=>M("num"))},i(t.value=="num"&&a.value=="ltb"?"▲":"▼")+" № ",3),e("div",{class:m(["sort-pill",{selected:t.value=="bring_bonus_kw_level_1"}]),onClick:l[4]||(l[4]=s=>M("kw"))},i(t.value=="bring_bonus_kw_level_1"&&a.value=="ltb"?"▲":"▼")+" kW ",3),e("div",{class:m(["sort-pill",{selected:t.value=="bring_bonus_tbtc_level_1"}]),onClick:l[5]||(l[5]=s=>M("tbtc"))},i(t.value=="bring_bonus_tbtc_level_1"&&a.value=="ltb"?"▲":"▼")+" fBTC ",3),e("div",{class:m(["sort-pill",{selected:t.value=="nft_count"}]),onClick:l[6]||(l[6]=s=>M("nft"))},i(t.value=="nft_count"&&a.value=="ltb"?"▲":"▼")+" NFT ",3)])):h("",!0)]),x.value.length>0?(c(),v("div",{key:0,class:"friends-list",style:_e(x.value.length>=5&&"height: calc(100vh - 350px);"),ref_key:"friendScrollContainer",ref:D},[(c(!0),v(S,null,N(x.value,(s,_)=>(c(),v("div",{class:"friend",key:_},[e("div",_t,[e("span",ct,"#"+i(_+1),1),e("span",vt,i((s==null?void 0:s.name)||(s==null?void 0:s.username)||(s==null?void 0:s.user_id)),1)]),e("div",dt,[e("div",bt,[k(o(z),{width:17,height:17}),e("div",pt,[l[8]||(l[8]=e("img",{src:L,width:"17px",height:"17px"},null,-1)),e("span",gt,i((s==null?void 0:s.bonus_kw_level_1)||0),1)]),e("div",ht,[l[9]||(l[9]=e("img",{src:O,width:"17px",height:"17px"},null,-1)),e("span",ft,i((s==null?void 0:s.bonus_tbtc_level_1)||0),1)])]),e("div",mt,[k(o(U),{width:17,height:17}),e("div",wt,[l[10]||(l[10]=e("img",{src:L,width:"17px",height:"17px"},null,-1)),e("span",kt,i((s==null?void 0:s.bonus_kw_level_2)||0),1)]),e("div",yt,[l[11]||(l[11]=e("img",{src:O,width:"17px",height:"17px"},null,-1)),e("span",Ct,i((s==null?void 0:s.bonus_tbtc_level_2)||0),1)])])]),e("div",xt,[e("div",Ft,[l[12]||(l[12]=e("img",{src:Re},null,-1)),e("span",Bt,i((s==null?void 0:s.nft_count)||0),1)])])]))),128))],4)):h("",!0),x.value.length>0?(c(),v("div",$t,[e("div",Tt,[e("ul",It,[(c(!0),v(S,null,N(we.value,s=>(c(),v("li",{class:m(["page-cell",{activepage:p.value==s,dots:s=="..."}]),key:s},i(s),3))),128))])]),e("div",Pt,[e("button",{class:m(["prev",{unactive:p.value==1}]),onClick:ye},i(o(r)("common.prev_page")),3),e("button",{class:m(["next",{unactive:p.value==P.value}]),onClick:ke},i(o(r)("common.next_page")),3)])])):h("",!0)])])],64)}}},Vt=xe(Et,[["__scopeId","data-v-b003315b"]]);export{Vt as default};
