const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/upg-modal-close-DfXHJzS2.js","assets/index-B0RY7NYi.js","assets/index-CDrq-qvZ.css"])))=>i.map(i=>d[i]);
import{_ as at,a as et,s as ot,v as h,r as lt,w as it,b as nt,G as dt,e as rt,o as ct,f as e,g as O,i as n,j as mt,t as c,cj as _t,p as f,D as b,A as ut,l as wt,m as ht}from"./index-B0RY7NYi.js";const ft={class:"modal-mask",name:"modal"},vt={class:"modal-wrapper"},bt={class:"modal-container"},xt={class:"grouping"},gt={class:"modal-header"},At={class:"modal-body"},kt={class:"price"},Ct={class:"tbtc-price"},Mt={class:"font-semibold flex gap-1"},Tt={class:"tbtc-price"},yt={class:"tbtc-price"},Dt={class:"font-semibold flex gap-1"},Bt={class:"tbtc-price"},Wt={class:"font-semibold flex gap-1"},qt={class:"tbtc-price"},Ft={class:"font-semibold flex gap-1"},St={class:"tbtc-price"},Vt={class:"font-semibold flex gap-1"},Rt={class:"tbtc-price"},Pt={class:"font-semibold flex gap-1"},Et={class:"buttons-group"},jt={__name:"WithdrawModal",props:{claim:Boolean},emits:["close"],setup(Q,{emit:Z}){var F;const $=mt(()=>wt(()=>import("./upg-modal-close-DfXHJzS2.js"),__vite__mapDeps([0,1,2]))),{t:i}=et(),t=ot(),l=Q,B=h(()=>{var a,s,o;return((a=t==null?void 0:t.user)==null?void 0:a.mined_tokens_balance)+((s=t==null?void 0:t.user)==null?void 0:s.mined_tokens_balance_s21)+((o=t==null?void 0:t.user)==null?void 0:o.mined_tokens_balance_sx)}),M=h(()=>{var a;return new Date((a=t.user)==null?void 0:a.premium_sub_expires)>=new Date}),H=h(()=>{var a,s;return l!=null&&l.claim?((a=t.withdraw_config)==null?void 0:a.min_claim)||2:((s=t.withdraw_config)==null?void 0:s.min_tbtc)||50}),W=h(()=>{var a;return Math.floor(l.claim?B.value:(a=t==null?void 0:t.user)==null?void 0:a.tbtc_wallet)}),T=h(()=>{var a,s,o;return Math.max(0,Math.min(Math.floor(((a=t==null?void 0:t.wallet_info)==null?void 0:a.tbtc_amount)+((s=t==null?void 0:t.wallet_info)==null?void 0:s.tbtc_amount_s21)+((o=t==null?void 0:t.wallet_info)==null?void 0:o.tbtc_amount_sx)),W.value))}),_=lt((F=Math.min(T.value,W.value))==null?void 0:F.toFixed(2)),x=h(()=>{var a,s,o,r;return(a=t==null?void 0:t.user)!=null&&a.has_silver_sbt&&((s=t==null?void 0:t.user)!=null&&s.has_silver_sbt_nft)?.0085:(o=t==null?void 0:t.user)!=null&&o.has_gold_sbt&&((r=t==null?void 0:t.user)!=null&&r.has_gold_sbt_nft)||M.value?.007:.01}),L=h(()=>_.value<100?1:+(_.value*x.value).toFixed(2)),y=h(()=>{var a,s;return+((((a=t==null?void 0:t.wallet_info)==null?void 0:a.tbtc_amount_s21)||0)+(((s=t==null?void 0:t.wallet_info)==null?void 0:s.tbtc_amount_sx)||0))}),X=h(()=>{var d;const a=_.value||0;if(a<=0)return 0;const s=((d=t==null?void 0:t.wallet_info)==null?void 0:d.tbtc_amount)||0,o=y.value;if(s+o===0)return 0;const r=s/(s+o),m=a*r;return+(m-m*x.value).toFixed(2)}),J=h(()=>{var d;const a=_.value||0;if(a<=0)return 0;const s=((d=t==null?void 0:t.wallet_info)==null?void 0:d.tbtc_amount)||0,o=y.value;if(s+o===0)return 0;const r=o/(s+o),m=a*r;return+(m-m*x.value).toFixed(2)}),K=h(()=>{var C;const a=_.value||0;if(a<=0)return 0;const s=((C=t==null?void 0:t.wallet_info)==null?void 0:C.tbtc_amount)||0,o=y.value;if(s+o===0)return 0;const r=s/(s+o),m=o/(s+o),u=a*r,d=a*m,w=u-u*x.value,v=(d-d*x.value)*.25;return+(w+v).toFixed(2)}),p=h(()=>{var w;const a=_.value||0;if(a<=0)return 0;const s=((w=t==null?void 0:t.wallet_info)==null?void 0:w.tbtc_amount)||0,o=y.value;if(s+o===0)return 0;const r=o/(s+o),m=a*r;return+((m-m*x.value)*.75).toFixed(2)});it(T,a=>{var s,o,r;l!=null&&l.claim?_.value=+((s=Math.min(a,B.value))==null?void 0:s.toFixed(2)):_.value=+((r=Math.min((o=t==null?void 0:t.user)==null?void 0:o.tbtc_wallet,a))==null?void 0:r.toFixed(2))});const{user:q}=nt(),A=dt(),k=Z,tt=()=>{k("close")};function D(a){const s=new Date,r=new Date(new Date(a).getTime()+24*60*60*1e3)-s;if(r<=0)return i("modals.withdraw_modal.time_expired");const m=Math.floor(r/(1e3*60*60)),u=Math.floor(r%(1e3*60*60)/(1e3*60));return i("modals.withdraw_modal.hours_minutes",{h:m,m:u})}async function st(){var u;const a=q==null?void 0:q.id,s=A.value,o=_.value,r=!!(l!=null&&l.claim),m={user_id:a,wallet_address:s,token_amount:o,token_contract_address:"EQBOqBiArR45GUlifxdzZ40ZahdVhjtU7GjY-lVtqruHvQEc",is_mining:r};try{await ht.post("create-withdrawal-request/",m).then(d=>{var w,g;if(d.status==200){const v=o<(l!=null&&l.claim?(w=t.withdraw_config)==null?void 0:w.max_auto_claim:(g=t.withdraw_config)==null?void 0:g.max_auto_tbtc)?i("modals.withdraw_modal.several_minutes"):i("modals.withdraw_modal.24_hours");k("close",{status:"success",title:i("notification.st_success"),body:l!=null&&l.claim?i("modals.withdraw_modal.claim_request_accepted",{amount:o,time:v}):i("modals.withdraw_modal.withdraw_request_accepted",{amount:o,time:v})})}}).catch(d=>{var w;console.error(d),k("close",{status:"error",title:i("notification.st_error"),body:d.response.data.error=="All fields are required"?i("modals.withdraw_modal.check_data_correctness"):d.response.data.error=="You can only make one withdrawal request per day"?l!=null&&l.claim?i("modals.withdraw_modal.next_claim_available",{time:D(d.response.data.last_date)}):i("modals.withdraw_modal.next_withdraw_available",{time:D((w=t.user)==null?void 0:w.last_withdrawal_date_tbtc)}):d.response.data.error})})}catch(d){k("close",{status:"error",title:i("notification.st_error"),body:d.response.data.error=="All fields are required"?i("modals.withdraw_modal.check_data_correctness"):d.response.data.error=="You can only make one withdrawal request per day"?l!=null&&l.claim?i("modals.withdraw_modal.next_claim_available",{time:D(d.response.data.last_date)}):i("modals.withdraw_modal.next_withdraw_available",{time:D((u=t.user)==null?void 0:u.last_withdrawal_date_tbtc)}):d.response.data.error})}}return(a,s)=>{var o,r,m,u,d,w,g,v,C,S,V,R,P,E,j,U,G,I,N,Y;return ct(),rt("div",ft,[e("div",vt,[e("div",bt,[e("button",{class:"close",onClick:s[0]||(s[0]=z=>k("close"))},[O(n($),{style:{color:"#fff"}})]),e("div",xt,[e("div",gt,c(l!=null&&l.claim?n(i)("modals.withdraw_modal.claim_fbtc"):n(i)("modals.withdraw_modal.withdraw_fbtc")),1),e("div",At,c(l!=null&&l.claim?n(i)("modals.withdraw_modal.claim_fbtc_desc",{address:((o=n(A))==null?void 0:o.slice(0,5))+"..."+n(A).slice(-5)}):n(i)("modals.withdraw_modal.withdraw_fbtc_desc",{address:((r=n(A))==null?void 0:r.slice(0,5))+"..."+n(A).slice(-5)})),1),O(_t,{modelValue:_.value,"onUpdate:modelValue":s[1]||(s[1]=z=>_.value=z),min:H.value,max:Math.max(W.value,T.value),available:T.value,disabled:""},null,8,["modelValue","min","max","available"]),e("div",kt,[e("div",Ct,[e("span",null,c(n(i)("modals.withdraw_modal.volume")),1),e("span",Mt,[f(c(_.value),1),s[2]||(s[2]=e("img",{class:"ml-1",src:b,width:"16px",height:"16px"},null,-1))])]),e("div",Tt,[e("span",null,c(l!=null&&l.claim?n(i)("modals.withdraw_modal.fee_for_claim"):n(i)("modals.withdraw_modal.fee_for_withdraw")),1),e("span",{class:ut(["font-semibold flex gap-1",{"text-[#FCD909]":((u=(m=n(t))==null?void 0:m.user)==null?void 0:u.has_silver_sbt)&&((w=(d=n(t))==null?void 0:d.user)==null?void 0:w.has_silver_sbt_nft)||((v=(g=n(t))==null?void 0:g.user)==null?void 0:v.has_gold_sbt)&&((S=(C=n(t))==null?void 0:C.user)==null?void 0:S.has_gold_sbt_nft)||M.value}])},[f(c(L.value)+" ",1),s[3]||(s[3]=e("img",{class:"ml-1",src:b,width:"16px",height:"16px"},null,-1)),f(" "+c((R=(V=n(t))==null?void 0:V.user)!=null&&R.has_silver_sbt&&((E=(P=n(t))==null?void 0:P.user)!=null&&E.has_silver_sbt_nft)||(U=(j=n(t))==null?void 0:j.user)!=null&&U.has_gold_sbt&&((I=(G=n(t))==null?void 0:G.user)!=null&&I.has_gold_sbt_nft)||M.value?`(${M.value?n(i)("boost.king"):"SBT"})`:""),1)],2)]),e("div",yt,[e("span",null,c(n(i)("modals.withdraw_modal.asics_s1_s19")),1),e("span",Dt,[f(c(X.value),1),s[4]||(s[4]=e("img",{class:"ml-1",src:b,width:"16px",height:"16px"},null,-1))])]),e("div",Bt,[e("span",null,c(n(i)("modals.withdraw_modal.asics_s21_sx")),1),e("span",Wt,[f(c(J.value),1),s[5]||(s[5]=e("img",{class:"ml-1",src:b,width:"16px",height:"16px"},null,-1))])]),e("div",qt,[e("span",null,c(n(i)("modals.withdraw_modal.to_wallet_fbtc")),1),e("span",Ft,[f(c(K.value)+" ",1),s[6]||(s[6]=e("img",{class:"ml-1",src:b,width:"16px",height:"16px"},null,-1))])]),e("div",St,[e("span",null,c(n(i)("modals.withdraw_modal.staking_amount")),1),e("span",Vt,[f(c(p.value),1),s[7]||(s[7]=e("img",{class:"ml-1",src:b,width:"16px",height:"16px"},null,-1))])]),e("div",Rt,[e("span",null,c(n(i)("modals.withdraw_modal.remaining_balance")),1),e("span",Pt,[f(c(Math.max(0,Math.floor(+(l!=null&&l.claim?B.value:(Y=(N=n(t))==null?void 0:N.user)==null?void 0:Y.tbtc_wallet)-_.value))),1),s[8]||(s[8]=e("img",{class:"ml-1",src:b,width:"16px",height:"16px"},null,-1))])])]),e("div",Et,[e("button",{class:"confirm",onClick:st},c(n(i)("modals.withdraw_modal.confirm")),1),e("button",{class:"cancel",onClick:tt},c(n(i)("modals.withdraw_modal.cancel")),1)])])])])])}}},Gt=at(jt,[["__scopeId","data-v-31cf04db"]]);export{Gt as W};
